<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>WorkLogAjaxApi</title>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>
    <div id="main"></div>
    <script>
        window.onload = init;
        var u = "http://111.53.74.132:8091/default.ashx";
        function init() {
            // login();
           // GetAllUsers();
           // AddProject();
           // GetProject();
           // DeleteProject();
           // UpdateProject();
            AddAccount();
           // UpdateAccount();
          //  DeleteAccount();
          //  GetUsrUnAddProject();
            //GetUsrInfo();
        }
        function log(str) {
            console.log(str);
            $("#main").html(str);
        }
        //获取用户某日期没有写的项目
        function GetUsrUnAddProject() {
            var d = {
                func: "GetUsrUnAddProject",
                day:"2019-03-12",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA=="
            }
            $.get(u, d, function (data) {
                log(data);
            }, "text");
        }
        //根据token获取用户信息
        function GetUsrInfo() {
            var d = {
                func: "GetUsrInfo",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA=="
            }
            $.get(u, d, function (data) {
                log(data);
            }, "text");
        }
        function login() {
            var d = {
                func: "login",
                usr: "admin",
                pwd:"admin",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA=="
            }
            $.get(u, d, function (data) {
                log(data);
            }, "text");
        }
        //获取所有用户列表
        function GetAllUsers() {
            var d = {
                func: "GetAllUsers",
                token:"YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA=="
            }
            $.get(u, d, function (data) {
                log(data);
            }, "text");
        }
        //管理员新增项目
        function AddProject() {
            var d = {
                project: "UPLAN",
                corp: "致讯",
                accounts: ["mzh","zgw","hsj"]
            }
            var ps = {
                func: "AddProject",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA==",
                data:d
            }
            var str = JSON.stringify(ps);
            $.post(u, str, function (data) {
                log(data);
            }, "text");    
        }
        //管理员查询项目
        function GetProject() {
            var d = {
                func: "GetProject",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA=="
            }
            $.get(u, d, function (data) {
                log(data);
            }, "text");
        }
        //管理员更新项目资料
        function UpdateProject() {
            var d = {
                project: "UPLAN",
                corp: "致讯",
                state:"1",  //项目状态，1为正常，0为关闭
                accounts: ["mzh", "zgw", "hsj","gyh"]
            }
            var ps = {
                func: "UpdateProject",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA==",
                data: d
            }
            var str = JSON.stringify(ps);
            $.post(u, str, function (data) {
                log(data);
            }, "text");    
        }
        //管理员删除项目
        function DeleteProject() {
            var d = {
                func: "DeleteProject",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA==",
                project: "test"
            }
            $.get(u, d, function (data) {
                log(data);
            }, "text");
        }
        //管理员新增用户账号
        function AddAccount() {
            var d = {
                account: "test2",
                password: "test2",
                name: "test2",
                corp: "致讯",
                state: "0", //账号状态  1正常，0异常，异常则不允许登陆   前端应默认 1
                power: "1",  /* 账号权限  1普通用户，9管理员 
                               前端应默认1并隐藏或置灰表单中权限字段(为了以后权限级别增多了做准备) 
                               暂时后台只允许创建比自己权限低的账户 */
                projects: ["APP","UPLAN"]
            }
            var ps = {
                func: "AddAccount",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA==",
                data: d
            }
            var str = JSON.stringify(ps);
            $.post(u, str, function (data) {
                log(data);
            }, "text");    
        }
        //管理员修改用户账号
        function UpdateAccount() {
            var d = {
                account: "test2", //主键
                name: "test",
                corp: "致讯",
                state: "0", 
                power: "1"  
            }
            var ps = {
                func: "UpdateAccount",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA==",
                data: d
            }
            var str = JSON.stringify(ps);
            $.post(u, str, function (data) {
                log(data);
            }, "text");
        }
         //管理员删除用户账号
        function DeleteAccount() {
            var d = {
                func: "DeleteAccount",
                token: "YWRtaW4jMjAxOS0wMS0yMSAxMTo1MzoyNA==",
                account:"test"
            }
            $.get(u, d, function (data) {
                log(data);
            }, "text");
        }
    </script>
</body>
</html>